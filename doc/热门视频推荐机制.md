## 热门视频推荐机制
### 说明
用户进入首页时从服务器获取视频列表的业务逻辑
### 步骤
1、获取当天热门视频列表，每页条目为50条（条目数量可以在后台管理系统中配置），若数量不足50条，查询今天发布的新视频补足至50条；  
2、步骤1若视频数量不足50条，则从昨天的热门视频中获取，若数量还不足50，则再从昨日发布视频中查询补足，之后按照此规律补足至50条；  
3、以上规律补足情况下最多往后查询5天数据（此天数可以在后台管理系统中配置）；直接查询视频库中5天前的视频，不区分是否为热门视频；  
4、以上步骤查询出来的视频列表根据上热门时间排序来做分页，最新发布的会被最先查询出来。被查询出来之后的列表将被打乱顺序。  
5、将打乱顺序的的列表做分组，每组10条（每组数量可以在后台管理系中配置），根据50条的数量可以分为5组  
6、判断用户是否登录，若登录则查询用户关注的人发布的视频，查询条目为5条（该条目数量可以在后台管理系统中配置），并将这5条随机插入到步骤5中的每组列表中  
7、根据广告机制获取广告列表，条目为5条（该条目数量可以在后台管理系统中配置），如果有置顶，则插入到上述步骤产生的列表中的第一位，置顶广告只判断权重最高的第一条；其他
    广告根据上热门、上前10条等规则插入到上述步骤产生列表中。  
### 解释
 上热门的视频有一个总数量，该数量默认为200条，可配置。每次获取先从这里获取，为分页获取，分页机制是根据上热门时间排序来做分页  
 上热门规则：点赞数X点赞权重 + 观看X观看权重 + 转发X转发权重 + 评论X评论权重  >= 热门门槛分数 则为热门视频  
 权重分值可在后台管理系统配置  
 广告插入原则：  
       1、将每次获取到的视频列表按照每组10条进行分组，50条即可分为5组  
       2、每条广告都有一个权重分数，分值越高，排名越靠前，越能被查看到，该分数由管理员在后台管理系统配置  
       3、广告有置顶、上前10，上热门三种属性，获取的顺序为置顶->上前10->上热门  
       4、若置顶广告有多条，则权重分数高的一条置顶，其余置顶视频按照上前10规则  
       5、上前10的视频，先将未能置顶的置顶视频按照权重分排序，分数最高的一条则会插入到前10位视频中，余下的视频将按照热门规则    
       6、上热门视频，现将以上连个步骤积累的视频随机插入到后面的第2组以及之后的分组中，每个分组只随机插入一个视频，上热门的视频也按照此规则插入到后面的分组中  
 规则中所有的数量皆可在后台管理系统中配置；  
